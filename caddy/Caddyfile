# WakeDock Dynamic Caddyfile
# This file will be dynamically updated by WakeDock
# Static configuration for WakeDock itself

{
    admin :2019
    auto_https off
    local_certs
}

# WakeDock Unified Service - HTTP
:80 {
    # API routes - route to backend service
    route /api/* {
        reverse_proxy wakedock:8000
    }
    
    # WebSocket routes - route to backend service
    route /ws {
        reverse_proxy wakedock:8000
    }
    
    # Dashboard (everything else)
    reverse_proxy dashboard:3000
}

# WakeDock Unified Service - HTTPS  
:443 {
    # API routes - route to backend service
    route /api/* {
        reverse_proxy wakedock:8000
    }
    
    # WebSocket routes - route to backend service
    route /ws {
        reverse_proxy wakedock:8000
    }
    
    # Dashboard (everything else)
    reverse_proxy dashboard:3000
}

# Direct API access (for backward compatibility)
:8000 {
    reverse_proxy wakedock:8000
}

# Direct API access - HTTPS (for backward compatibility)
:8443 {
    reverse_proxy wakedock:8000
}

# Dynamic service configurations will be appended below this line
# --- WAKEDOCK MANAGED SERVICES ---
